(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["npm.https-proxy-agent"],{"1f4f":function(t,e,n){"use strict";(function(t){var o=this&&this.__awaiter||function(t,e,n,o){function r(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,s){function c(t){try{u(o.next(t))}catch(e){s(e)}}function i(t){try{u(o["throw"](t))}catch(e){s(e)}}function u(t){t.done?n(t.value):r(t.value).then(c,i)}u((o=o.apply(t,e||[])).next())}))},r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=r(n("3e8f")),c=r(n("3e8f")),i=r(n("0b16")),u=r(n("f654")),a=r(n("34eb")),f=n("45d8"),l=r(n("276c")),p=a.default("https-proxy-agent:agent");class d extends f.Agent{constructor(t){let e;if(e="string"===typeof t?i.default.parse(t):t,!e)throw new Error("an HTTP(S) proxy server `host` and `port` must be specified!");p("creating new HttpsProxyAgent instance: %o",e),super(e);const n=Object.assign({},e);this.secureProxy=e.secureProxy||g(n.protocol),n.host=n.hostname||n.host,"string"===typeof n.port&&(n.port=parseInt(n.port,10)),!n.port&&n.host&&(n.port=this.secureProxy?443:80),this.secureProxy&&!("ALPNProtocols"in n)&&(n.ALPNProtocols=["http 1.1"]),n.host&&n.path&&(delete n.path,delete n.pathname),this.proxy=n}callback(e,n){return o(this,void 0,void 0,(function*(){const{proxy:o,secureProxy:r}=this;let i;r?(p("Creating `tls.Socket`: %o",o),i=c.default.connect(o)):(p("Creating `net.Socket`: %o",o),i=s.default.connect(o));const a=Object.assign({},o.headers),f=`${n.host}:${n.port}`;let d=`CONNECT ${f} HTTP/1.1\r\n`;o.auth&&(a["Proxy-Authorization"]="Basic "+t.from(o.auth).toString("base64"));let{host:g,port:x,secureEndpoint:v}=n;y(x,v)||(g+=":"+x),a.Host=g,a.Connection="close";for(const t of Object.keys(a))d+=`${t}: ${a[t]}\r\n`;const m=l.default(i);i.write(d+"\r\n");const{statusCode:w,buffered:P}=yield m;if(200===w){if(e.once("socket",h),n.secureEndpoint){const t=n.servername||n.host;if(!t)throw new Error('Could not determine "servername"');return p("Upgrading socket connection to TLS"),c.default.connect(Object.assign(Object.assign({},b(n,"host","hostname","path","port")),{socket:i,servername:t}))}return i}i.destroy();const _=new s.default.Socket;return _.readable=!0,e.once("socket",t=>{p("replaying proxy buffer for failed request"),u.default(t.listenerCount("data")>0),t.push(P),t.push(null)}),_}))}}function h(t){t.resume()}function y(t,e){return Boolean(!e&&80===t||e&&443===t)}function g(t){return"string"===typeof t&&/^https:?$/i.test(t)}function b(t,...e){const n={};let o;for(o in t)e.includes(o)||(n[o]=t[o]);return n}e.default=d}).call(this,n("b639").Buffer)},"1f7d":function(t,e,n){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};const r=o(n("1f4f"));function s(t){return new r.default(t)}(function(t){t.HttpsProxyAgent=r.default,t.prototype=r.default.prototype})(s||(s={})),t.exports=s},"276c":function(t,e,n){"use strict";(function(t){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=o(n("34eb")),s=r.default("https-proxy-agent:parse-proxy-response");function c(e){return new Promise((n,o)=>{let r=0;const c=[];function i(){const t=e.read();t?p(t):e.once("readable",i)}function u(){e.removeListener("end",f),e.removeListener("error",l),e.removeListener("close",a),e.removeListener("readable",i)}function a(t){s("onclose had error %o",t)}function f(){s("onend")}function l(t){u(),s("onerror %o",t),o(t)}function p(e){c.push(e),r+=e.length;const o=t.concat(c,r),u=o.indexOf("\r\n\r\n");if(-1===u)return s("have not received end of HTTP headers yet..."),void i();const a=o.toString("ascii",0,o.indexOf("\r\n")),f=+a.split(" ")[1];s("got proxy server response: %o",a),n({statusCode:f,buffered:o})}e.on("error",l),e.on("close",a),e.on("end",f),i()})}e.default=c}).call(this,n("b639").Buffer)}}]);
//# sourceMappingURL=npm.https-proxy-agent-legacy.cac457ed.js.map